.TH CCDSTAT 1NEMO "24 May 2005"
.SH NAME
ccdstat \- statistics (1st through 4th moment) and chi2
.SH SYNOPSIS
.PP
\fBccdstat in=\fPimage [parameter=value]
.SH DESCRIPTION
\fBccdstat\fP calculates all moments (up to fourth order) of the values
in an image/cube, 
and calculate some human understandable numbers (mean, dispersion, skewness,
curtosis) from them. It can optionally use a weighting map, in case the 
map needs to weighted per pixel.
.PP
Optionally, if the map contains an error normalized difference between an
observation and model, it can also compute a chi2 goodness of
fit if the number of 
of fitting parameters is given
(\fBnpar\fP, must be > 0 to trigger this option),
as well as the number of independant points per beam (\fBnppb\fP):
.nf
    chi2 = sum_{i,j}(map(i,j)^2)/nppb/(N/nppb-npar)
.fi
where N is the number of non-bad values in the map. The input 
map is now assumed to contain a dimensionless \fI(obs-mod)/sigma\fP
.SH PARAMETERS
The following parameters are recognized in any order if the keyword is also
given:
.TP 20
\fBin=\fIin-file\fP
input file, in \fIImage(5)\fP format [no default]
.TP
\fBmin=\fImin_value\fP
If given, all values below this value are ignored in the statistics. 
By default no lower limit is used.
.TP
\fPmax=\fImax_value\fP
If given, all values above this value are ignored in the statistics.
By default no upper limit is used.
.TP
\fBbad=\fIbad_value\fP
If given, all values identical to this value are ignored in the statistics.
Note that, apart for bad=0, it is dangerous to use equating to a real value
as a masking operating.
.TP
\fBwin=\fIweight-file\fP
optional input file, in \fIImage(5)\fP format, of which the mapvalues
are used as a relative weight factor. Should be all positive, with 0
meaning no weight.
[no default]
.TP
\fBnpar=\fP
Number of fitting parameters. If given > 0, this will trigger the
computation of chi2 goodness of fit, instead of the normal statistics.
.TP
\fBnppb=\fP
Number of (independant) points per beam. Only used in the computation
for chi2, and 
.TP
\fBmedian=t|f\fP
Optional display of the median value
.TP
\fBmmcount=t|f\fP
Count occurances of min and max 
.TP
\fBsort=t|f\fP
Sorting routine (not activated yet) 
.SH "EXAMPLE"
.nf
  % ccdstat image.ccd min=-2
Min=-1.879409  Max=2.265516
Number of points     : 95
Mean and dispersion  : 0.097891 0.956030
Skewness and kurtosis: -0.059936 -0.654776
5/100 out-of-range points discarded
.fi
Here is an example how to created a weight file which is a circular annulus:
.nf
  % ccdmath out=map1 "fie=iflt(%r,50,1,0)" size=200,200 crpix=100,100
  % ccdmath out=map2 "fie=iflt(%r,20,1,0)" size=200,200 crpix=100,100
  % ccdmath map1,map2 map3 %1-%2
.fi
Here is an two masking example: firstignoring the exact value of 0, 
followed by an example of a small range around 0:
.nf
  % ccdstat map1 bad=0
  % ccdmath map1 - 'iflt(abs(%1),0.001,0,%1)' | ccdstat - bad=0
.fi
Here is an example of calculating the chi2 goodness of fit for
a gaussian distribution:
.nf
  % ccdmath "" - "rang(0,1)" | ccdstat - npar=1	
Generating a map from scratch
chi2= 1.03431
df= 98
.fi
.SH "SEE ALSO"
snapccd(1NEMO), image(5NEMO)
.SH AUTHOR
Peter Teuben
.SH FILES
.nf
.ta +2.5i
src/image/misc	ccdstat.c
.fi
.SH "UPDATE HISTORY"
.nf
.ta +1.0i +4.0i
 4-Oct-88	V1.0: Created		PJT
9-may-03	V1.3: added bad=	PJT
5-jun-03	V1.4: added win=	PJT
14-nov-04	V1.5: added the chi2 trigger with npar= and nppb=	PJT
24-may-06	V1.8: added mmcount	PJT
.fi
